<!DOCTYPE html>
<html lang="ja">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Level 22 Goal  A program is running automatically at regular intervals from cron, the time-based job scheduler. Look in /etc/cron.d/ for the configuration and see what command is being executed.
  cronã§ã©ã®ã‚³ãƒãƒ³ãƒ‰ãŒå‹•ã„ã¦ã„ã‚‹ã®ã‹ã‚’ã¿ã‚‹  resolve bandit21@bandit:~$ cd /etc/cron.d cronjob_bandit15_root cronjob_bandit17_root cronjob_bandit22 cronjob_bandit23 cronjob_bandit24 cronjob_bandit25_root bandit21@bandit:/etc/cron.d$ cat cronjob_bandit22 @reboot bandit22 /usr/bin/cronjob_bandit22.sh &amp;amp;&amp;gt; /dev/null * * * * * bandit22 /usr/bin/cronjob_bandit22.sh &amp;amp;&amp;gt; /dev/null bandit21@bandit:/etc/cron.d$ cat /usr/bin/cronjob_bandit22.sh #!/bin/bash chmod 644 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv cat /etc/bandit_pass/bandit22 &amp;gt; /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv bandit21@bandit:/etc/cron.'><title>ã€OverTheWireå¥®é—˜è¨˜ã€‘Bandit: Level22ã€œ24</title>

<link rel='canonical' href='https://tadakun8.github.io/post/over-the-wire/bandit/level22-24/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='ã€OverTheWireå¥®é—˜è¨˜ã€‘Bandit: Level22ã€œ24'>
<meta property='og:description' content='Level 22 Goal  A program is running automatically at regular intervals from cron, the time-based job scheduler. Look in /etc/cron.d/ for the configuration and see what command is being executed.
  cronã§ã©ã®ã‚³ãƒãƒ³ãƒ‰ãŒå‹•ã„ã¦ã„ã‚‹ã®ã‹ã‚’ã¿ã‚‹  resolve bandit21@bandit:~$ cd /etc/cron.d cronjob_bandit15_root cronjob_bandit17_root cronjob_bandit22 cronjob_bandit23 cronjob_bandit24 cronjob_bandit25_root bandit21@bandit:/etc/cron.d$ cat cronjob_bandit22 @reboot bandit22 /usr/bin/cronjob_bandit22.sh &amp;amp;&amp;gt; /dev/null * * * * * bandit22 /usr/bin/cronjob_bandit22.sh &amp;amp;&amp;gt; /dev/null bandit21@bandit:/etc/cron.d$ cat /usr/bin/cronjob_bandit22.sh #!/bin/bash chmod 644 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv cat /etc/bandit_pass/bandit22 &amp;gt; /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv bandit21@bandit:/etc/cron.'>
<meta property='og:url' content='https://tadakun8.github.io/post/over-the-wire/bandit/level22-24/'>
<meta property='og:site_name' content='ãŸã ãã‚“ã¶ã‚ã'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2021-06-24T12:30:46&#43;09:00'/><meta property='article:modified_time' content='2021-06-24T12:30:46&#43;09:00'/>
<meta name="twitter:title" content="ã€OverTheWireå¥®é—˜è¨˜ã€‘Bandit: Level22ã€œ24">
<meta name="twitter:description" content="Level 22 Goal  A program is running automatically at regular intervals from cron, the time-based job scheduler. Look in /etc/cron.d/ for the configuration and see what command is being executed.
  cronã§ã©ã®ã‚³ãƒãƒ³ãƒ‰ãŒå‹•ã„ã¦ã„ã‚‹ã®ã‹ã‚’ã¿ã‚‹  resolve bandit21@bandit:~$ cd /etc/cron.d cronjob_bandit15_root cronjob_bandit17_root cronjob_bandit22 cronjob_bandit23 cronjob_bandit24 cronjob_bandit25_root bandit21@bandit:/etc/cron.d$ cat cronjob_bandit22 @reboot bandit22 /usr/bin/cronjob_bandit22.sh &amp;amp;&amp;gt; /dev/null * * * * * bandit22 /usr/bin/cronjob_bandit22.sh &amp;amp;&amp;gt; /dev/null bandit21@bandit:/etc/cron.d$ cat /usr/bin/cronjob_bandit22.sh #!/bin/bash chmod 644 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv cat /etc/bandit_pass/bandit22 &amp;gt; /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv bandit21@bandit:/etc/cron.">
    </head>
    <body class="">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.body.dataset.scheme = 'dark';
        } else {
            document.body.dataset.scheme = 'light';
        }
    })();
</script><div class="container main-container flex on-phone--column extended article-page with-toolbar">
            <aside class="sidebar left-sidebar sticky">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header class="site-info">
        
            <figure class="site-avatar">
                
                    
                    
                    
                        
                        <img src="/img/avatar_huda2458f72ce188392d75c5d51cd8e24e_373_300x0_resize_box_2.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                

                
                    <span class="emoji">ğŸ¥</span>
                
            </figure>
        
        <h1 class="site-name"><a href="https://tadakun8.github.io">ãŸã ãã‚“ã¶ã‚ã</a></h1>
        <h2 class="site-description">æŠ€è¡“ãƒ–ãƒ­ã‚°ã¯ã˜ã‚ã¾ã—ãŸ</h2>
    </header>

    <ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/about/'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        

        <li >
            <a href='/archives/'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        

        <li >
            <a href='/search/'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        
            <li id="dark-mode-toggle">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <span>Dark Mode</span>
            </li>
        
    </ol>
</aside>

            <main class="main full-width">
    <div id="article-toolbar">
        <a href="https://tadakun8.github.io" class="back-home">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



            <span>Back</span>
        </a>
    </div>

    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/overthewire/" >
                OverTheWire
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/post/over-the-wire/bandit/level22-24/">ã€OverTheWireå¥®é—˜è¨˜ã€‘Bandit: Level22ã€œ24</a>
    </h2>

    <footer class="article-time">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <time class="article-time--published">2021-06-24</time>
    </footer></div>
</header>

    <section class="article-content">
    <h2 id="level-22">Level 22</h2>
<h3 id="goal">Goal</h3>
<blockquote>
<p>A program is running automatically at regular intervals from cron, the time-based job scheduler. Look in /etc/cron.d/ for the configuration and see what command is being executed.</p>
</blockquote>
<ul>
<li>cronã§ã©ã®ã‚³ãƒãƒ³ãƒ‰ãŒå‹•ã„ã¦ã„ã‚‹ã®ã‹ã‚’ã¿ã‚‹</li>
</ul>
<h3 id="resolve">resolve</h3>
<pre><code>bandit21@bandit:~$ cd /etc/cron.d
cronjob_bandit15_root  cronjob_bandit17_root  cronjob_bandit22  cronjob_bandit23  cronjob_bandit24  cronjob_bandit25_root
bandit21@bandit:/etc/cron.d$ cat cronjob_bandit22
@reboot bandit22 /usr/bin/cronjob_bandit22.sh &amp;&gt; /dev/null
* * * * * bandit22 /usr/bin/cronjob_bandit22.sh &amp;&gt; /dev/null
bandit21@bandit:/etc/cron.d$ cat /usr/bin/cronjob_bandit22.sh 
#!/bin/bash
chmod 644 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
cat /etc/bandit_pass/bandit22 &gt; /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
bandit21@bandit:/etc/cron.d$ cat /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
Yk7owGAcWjwMVRwrTesJEwB7WVOiILLI
bandit21@bandit:/etc/cron.d$ exit

# ä»¥ä¸‹ã¯ãƒ­ãƒ¼ã‚«ãƒ«ã§å®Ÿè¡Œ
$ ssh -l bandit22 -p 2220 bandit.labs.overthewire.org
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

bandit22@bandit.labs.overthewire.org's password: Yk7owGAcWjwMVRwrTesJEwB7WVOiILLI
</code></pre><h3 id="resolveã¾ã§ã«ã‚„ã£ãŸã“ã¨">resolveã¾ã§ã«ã‚„ã£ãŸã“ã¨</h3>
<p>å•é¡Œæ–‡ã§<code>/etc/cron.d</code>ã®ãªã‹ã«ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹ã¨ã®ã“ã¨ãªã®ã§ã€ãã“ã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãŸã©ã£ã¦ã„ããƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚</p>
<h2 id="level-23">Level 23</h2>
<h3 id="goal-1">Goal</h3>
<blockquote>
<p>A program is running automatically at regular intervals from cron, the time-based job scheduler. Look in /etc/cron.d/ for the configuration and see what command is being executed.
NOTE: Looking at shell scripts written by other people is a very useful skill. The script for this level is intentionally made easy to read. If you are having problems understanding what it does, try executing it to see the debug information it prints.</p>
</blockquote>
<ul>
<li>cronã§ã©ã®ã‚³ãƒãƒ³ãƒ‰ãŒå‹•ã„ã¦ã„ã‚‹ã®ã‹ã‚’è¦‹ã‚‹</li>
</ul>
<h3 id="resolve-1">resolve</h3>
<pre><code>bandit22@bandit:~$ cd /etc/cron.d
bandit22@bandit:/etc/cron.d$ ls
cronjob_bandit15_root  cronjob_bandit17_root  cronjob_bandit22  cronjob_bandit23  cronjob_bandit24  cronjob_bandit25_root
bandit22@bandit:/etc/cron.d$ cat cronjob_bandit23
@reboot bandit23 /usr/bin/cronjob_bandit23.sh  &amp;&gt; /dev/null
* * * * * bandit23 /usr/bin/cronjob_bandit23.sh  &amp;&gt; /dev/null
bandit22@bandit:/etc/cron.d$ cat /usr/bin/cronjob_bandit23.sh
#!/bin/bash

myname=$(whoami)
mytarget=$(echo I am user $myname | md5sum | cut -d ' ' -f 1)

echo &quot;Copying passwordfile /etc/bandit_pass/$myname to /tmp/$mytarget&quot;

cat /etc/bandit_pass/$myname &gt; /tmp/$mytarget
bandit22@bandit:/etc/cron.d$ echo I am user bandit23 | md5sum | cut -d ' ' -f 1
8ca319486bfbbc3663ea0fbe81326349
bandit22@bandit:/etc/cron.d$ cat /tmp/8ca319486bfbbc3663ea0fbe81326349
bandit22@bandit:/etc/cron.d$ exit

# ä»¥ä¸‹ã¯ãƒ­ãƒ¼ã‚«ãƒ«ã§å®Ÿè¡Œ
$ ssh -l bandit23 -p 2220 bandit.labs.overthewire.org
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

bandit23@bandit.labs.overthewire.org's password: jc1udXuA1tiHqjIsL8yaapX5XIAI6i0n
</code></pre><h3 id="resolveã¾ã§ã«ã‚„ã£ãŸã“ã¨-1">resolveã¾ã§ã«ã‚„ã£ãŸã“ã¨</h3>
<p>Level22åŒã˜ã‚ˆã†ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãŸã©ã£ã¦ã„ãã¾ã—ãŸã€‚</p>
<h2 id="level-24">Level 24</h2>
<h3 id="goal-2">Goal</h3>
<blockquote>
<p>A program is running automatically at regular intervals from cron, the time-based job scheduler. Look in /etc/cron.d/ for the configuration and see what command is being executed.
NOTE: This level requires you to create your own first shell-script. This is a very big step and you should be proud of yourself when you beat this level!
NOTE 2: Keep in mind that your shell script is removed once executed, so you may want to keep a copy aroundâ€¦</p>
</blockquote>
<ul>
<li>cronã§ã©ã®ã‚³ãƒãƒ³ãƒ‰ãŒå‹•ã„ã¦ã„ã‚‹ã®ã‹ã‚’è¦‹ã‚‹</li>
<li>ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œã£ã¦ã¿ã‚‹</li>
</ul>
<h3 id="resolve-2">resolve</h3>
<pre><code>bandit23@bandit:~$ mkdir -p /tmp/shell
bandit23@bandit:~$ cd /tmp/shell
bandit23@bandit:/tmp/shell$ vim cat-password.sh
#!/bin/bash
cat /etc/bandit_pass/bandit24 &gt; /tmp/shell/password
bandit23@bandit:/tmp/shell$ chmod +x cat-password.sh
bandit23@bandit:/tmp/shell$ touch password
bandit23@bandit:/tmp/shell$ chmod 666 password
bandit23@bandit:/tmp/shell$ cp cat-password.sh /var/spool/bandit24
(1åˆ†å¾…ã¤)
bandit23@bandit:/tmp/shell$ cat password 
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ
bandit23@bandit:/tmp/shell$ exit

# ä»¥ä¸‹ã¯ãƒ­ãƒ¼ã‚«ãƒ«ã§
$ 
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

bandit24@bandit.labs.overthewire.org's password: UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ
</code></pre><h3 id="resolveã¾ã§ã«ã‚„ã£ãŸã“ã¨-2">resolveã¾ã§ã«ã‚„ã£ãŸã“ã¨</h3>
<h4 id="ã¾ãšã¯cdã¨catã™ã‚‹">ã¾ãšã¯cdã¨catã™ã‚‹</h4>
<p><code>cd /etc/cron.d</code>ã€<code>cat cronjob_bandit24</code>ã™ã‚‹ã¨</p>
<pre><code>bandit23@bandit:/etc/cron.d$ cat cronjob_bandit24 
@reboot bandit24 /usr/bin/cronjob_bandit24.sh &amp;&gt; /dev/null
* * * * * bandit24 /usr/bin/cronjob_bandit24.sh &amp;&gt; /dev/null
</code></pre><p>cronã§<code>@reboot</code>ã¯è¦‹ãŸã“ã¨ãªã‹ã£ãŸã®ã§ã™ãŒã€èª¿ã¹ã¦è¦‹ã‚‹ã¨ã‚·ã‚¹ãƒ†ãƒ èµ·å‹•æ™‚ã«ä¸€å›ã ã‘å®Ÿè¡Œã™ã‚‹ã¨ãã«æŒ‡å®šã™ã‚‹ã‚‚ã®ã‚‰ã—ã„ã§ã™(<code>man 5 crontab</code>ã«è¨˜è¼‰ãŒã‚ã‚Šã¾ã—ãŸ)</p>
<p><code>@reboot</code>ã«ã¤ã„ã¦ã‚ã‹ã£ãŸã®ã§ã€æ”¹ã‚ã¦<code>cat</code>ã®çµæœã‚’è¦‹ã¦ã¿ã‚‹ã¨ã€<code>/usr/bin/cronjob_bandit24.sh</code>ãŒå‹•ã„ã¦ã„ã‚‹ã‚‰ã—ã„ã®ã§ã€ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’<code>cat</code>ã—ã¾ã™ã€‚</p>
<pre><code>bandit23@bandit:/etc/cron.d$ cat -n /usr/bin/cronjob_bandit24.sh 
     1  #!/bin/bash
     2
     3  myname=$(whoami)
     4
     5  cd /var/spool/$myname
     6  echo &quot;Executing and deleting all scripts in /var/spool/$myname:&quot;
     7  for i in * .*;
     8  do
     9      if [ &quot;$i&quot; != &quot;.&quot; -a &quot;$i&quot; != &quot;..&quot; ];
    10      then
    11          echo &quot;Handling $i&quot;
    12          owner=&quot;$(stat --format &quot;%U&quot; ./$i)&quot;
    13          if [ &quot;${owner}&quot; = &quot;bandit23&quot; ]; then
    14              timeout -s 9 60 ./$i
    15          fi
    16          rm -f ./$i
    17      fi
    18  done
    19
</code></pre><h4 id="shellã‚’æ¢ã‚‹">shellã‚’æ¢ã‚‹</h4>
<p>3è¡Œç›®ã®<code>whoami</code>ã®çµæœã¯ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’<code>ls -l</code>ã™ã‚‹ã¨<code>bandit24</code>ã¨ã‚ã‹ã‚Šã¾ã—ãŸ</p>
<pre><code>bandit23@bandit:/etc/cron.d$ ls -l /usr/bin/cronjob_bandit24.sh 
-rwxr-x--- 1 bandit24 bandit23 376 May 14  2020 /usr/bin/cronjob_bandit24.sh
</code></pre><p>ãªã®ã§ã€5è¡Œç›®ã¯<code>cd /var/spool/bandit24</code>ã§ã™ã­ã€‚</p>
<p>7è¡Œç›®ã®<code>for i in * .*;</code>ã¯<code>/var/spool/bandit24</code>ã«ã‚ã‚‹å…¨ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ«ãƒ¼ãƒ—ã•ã›ã¦ã„ã¾ã™ã€‚</p>
<p>9è¡Œç›®ã‚’è¦‹ã‚‹ã¨ã€ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨ãã®1ã¤å‰ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥å¤–ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¯¾è±¡ã«ã—ãŸå‡¦ç†ã ã¨ã‚ã‹ã‚Šã¾ã™ã€‚</p>
<p>ç¶šã„ã¦<code>stat</code>ã§ã™ãŒã€ãƒ•ã‚¡ã‚¤ãƒ«ã®å±æ€§ã‚„çŠ¶æ…‹ã‚’è¡¨ç¤ºã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã§ã™ã€‚<code>ls</code>ã¨ã®é•ã„ã§ã™ãŒã€statã®æ–¹ãŒã€ã‚ˆã‚Šç´°ã‹ã„å±æ€§ã‚„çŠ¶æ…‹ã‚’è¡¨ç¤ºã§ãã‚‹ã¨å—ã‘å–ã‚Šã¾ã—ãŸã€‚
<code>stat --format &quot;%U&quot; ãƒ•ã‚¡ã‚¤ãƒ«å</code>ã§ãã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚ªãƒ¼ãƒŠãƒ¼ã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚</p>
<p>æ¬¡ã«<code>timeout</code>ã‚³ãƒãƒ³ãƒ‰ã§ã™ãŒã€åˆ¶é™æ™‚é–“ã‚’æŒ‡å®šã—ã¦ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã§ã™ã€‚</p>
<p><code>timeout -s 9 60 ./$i</code>ã®æ„å‘³ã§ã™ãŒã€ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œã«60ç§’é–“ã¨ã„ã†åˆ¶é™æ™‚é–“ã‚’ã‚‚ã†ã‘ã¦ã€60ç§’è¶…ãˆãŸã‚‰<code>-s 9</code>ã€ã‚·ã‚°ãƒŠãƒ«ã®9ã‚’é€ä¿¡ã™ã‚‹ã¨ã„ã†æ„å‘³ã§ã™ã€‚ã‚·ã‚°ãƒŠãƒ«ã®9ã¯å¼·åˆ¶çµ‚äº†ã‚’æ„å‘³ã—ã¾ã™ã€‚</p>
<p>ã¤ã¾ã‚Šã€ã‚³ãƒãƒ³ãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã¦60ç§’çµŒã£ãŸã‚‰ãã®ã‚³ãƒãƒ³ãƒ‰ã‚’å¼·åˆ¶çµ‚äº†ã™ã‚‹ã¨ã„ã†ã“ã¨ã§ã™ã€‚</p>
<p>Goalã«ã‚·ã‚§ãƒ«ã‚’ä½œã‚‹æ—¨ã®æ–‡ãŒã‚ã‚‹ã®ã§ã€<code>/var/spool/bandit24</code>ã«ã‚·ã‚§ãƒ«ã‚’ä½œã‚Œã°ã„ã„ã®ã‹ãªã¨å½“ãŸã‚Šã‚’ã¤ã‘ã¾ã—ãŸã€‚</p>
<h4 id="shellã‚’ä½œã‚‹">shellã‚’ä½œã‚‹</h4>
<p><code>vi display-date.sh</code>ä»¥ä¸‹ã®ã‚·ã‚§ãƒ«ã‚’ä½œã£ã¦ã¿ã¾ã—ãŸã€‚</p>
<div class="highlight"><pre class="chroma"><code class="language-sh:display-date.sh" data-lang="sh:display-date.sh"><span class="cp">#!/bin/sh
</span><span class="cp"></span>
<span class="k">while</span> <span class="nb">true</span>
<span class="k">do</span>
  sleep <span class="m">1</span>
  date
<span class="k">done</span>
</code></pre></div><h4 id="ãã‚Œã§">ãƒ»ãƒ»ãƒ»ãã‚Œã§ï¼Ÿ</h4>
<p>shellã‚‚ä½œã£ã¦<code>/var/spool/bandit24</code>ã«é…ç½®ã•ã›ãŸã®ã§ã™ãŒã€ã“ã“ã‹ã‚‰æ‰‹ãŒã¤ãã¾ã—ãŸã€‚çµå±€ã“ã®ã‚·ã‚§ãƒ«ã‹ã‚‰ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ã©ã†ã‚„ã£ã¦æ‰‹ã«å…¥ã‚Œã‚‹ã‚“ã ã‚ã†ã¨ãšã£ã¨æ‚©ã‚“ã§ã„ã¾ã—ãŸã€‚</p>
<p>ã¨ã„ã†ã“ã¨ã§ã€è«¦ã‚ã¦å›ç­”ã‚’æ¢ã—ã¾ã—ãŸã€‚å›ç­”ã¯ã“ã¡ã‚‰ã®ã‚µã‚¤ãƒˆã‚’å‚è€ƒã«ã—ã¾ã—ãŸã€‚</p>
<ul>
<li><a href="https://medium.com/secttp/overthewire-bandit-level-23-424786d305bf">https://medium.com/secttp/overthewire-bandit-level-23-424786d305bf</a></li>
</ul>
<p>ãªã‚‹ã»ã©ã€ã©ã†ã‚„ã‚‰<code>/etc/bandit_pass/</code>ã«å…¨ã¦ã®Levelã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã¿ãŸã„ã§ã™ã€‚</p>
<p>ãã—ã¦ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ç½®ãå ´ã¯<code>/tmp</code>ä»¥ä¸‹ã«ä½œã‚Œã°è‰¯ã•ãã†ã§ã—ãŸã€‚</p>
<p>ãªã®ã§ã€æ–¹é‡ã¨ã—ã¦<code>/tmp</code>ã«ã‚·ã‚§ãƒ«ã‚’ä½œã‚Šã€å®Ÿè¡Œæ¨©é™ã‚’èª¿æ•´ã—ã€ä½œæˆã—ãŸã‚‚ã®ã‚’<code>cp</code>ã§<code>/var/spool/bandit24</code>ã«æ ¼ç´ã™ã‚‹ã“ã¨ã§ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå–å¾—ã§ããã†ã§ã™</p>
<h3 id="ãŠã‚ã‚Š">ãŠã‚ã‚Š</h3>
<p>æ¬¡ä»¥é™ã«banditã‚’é€²ã‚ã‚‹ã«å½“ãŸã£ã¦ã€ã„ãã¤ã‹é‡è¦ãªã‚‚ã®ãŒå‡ºã¦ãã¾ã—ãŸã€‚</p>
<p>ã¾ã¨ã‚ã‚‹ã¨ãƒ»ãƒ»ãƒ»</p>
<ul>
<li><code>/etc/bandit_pass</code>ã«å…¨ã¦ã®Levelã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹</li>
<li>Levelã«ã‚ˆã£ã¦ã¯ä¸Šè¨˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä¸­ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å–å¾—ã™ã‚‹å¿…è¦ãŒã‚ã‚‹</li>
<li>ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã®å ´æ‰€ã¯<code>/tmp</code>ä»¥ä¸‹ã«ä½œã‚Œã‚‹</li>
</ul>
<p>ä»Šã¾ã§ã¯é€²ã‚ã¦ã„ãã†ã¡ã«ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ‰‹ã«å…¥ã£ãŸã‚‚ã®ãŒå¤šã‹ã£ãŸã®ã§ã€ã“ã†ã„ã†æƒ…å ±ã¯è¦šãˆã¦ãŠãã¾ã™ã€‚</p>

</section>


    <footer class="article-footer">
    

    </footer>

    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="">
    <a href="/post/over-the-wire/bandit/level33-34/">
        
        

        <div class="article-details">
            <h2 class="article-title">ã€OverTheWireå¥®é—˜è¨˜ã€‘Bandit: Level33ã€œ34</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/over-the-wire/bandit/level31-32/">
        
        

        <div class="article-details">
            <h2 class="article-title">ã€OverTheWireå¥®é—˜è¨˜ã€‘Bandit: Level31ã€œ32</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/over-the-wire/bandit/level28-30/">
        
        

        <div class="article-details">
            <h2 class="article-title">ã€OverTheWireå¥®é—˜è¨˜ã€‘Bandit: Level28ã€œ30</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/over-the-wire/bandit/level25-27/">
        
        

        <div class="article-details">
            <h2 class="article-title">ã€OverTheWireå¥®é—˜è¨˜ã€‘Bandit: Level25ã€œ27</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/over-the-wire/bandit/level19-21/">
        
        

        <div class="article-details">
            <h2 class="article-title">ã€OverTheWireå¥®é—˜è¨˜ã€‘Bandit: Level19ã€œ21</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>


    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2021 ãŸã ãã‚“ã¶ã‚ã
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="2.3.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >
            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
