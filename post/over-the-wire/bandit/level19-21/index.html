<!DOCTYPE html>
<html lang="ja">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Level 19 Goal  The password for the next level is stored in a file readme in the homedirectory. Unfortunately, someone has modified .bashrc to log you out when you log in with SSH.
  ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯readmeãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚ã‚‹ èª°ã‹ãŒ.bashrcãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿®æ­£ã—ã€SSHã§ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ã¨ãã«ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã™ã‚‹ã‚ˆã†ã«è¨­å®šã—ã¦ã„ã‚‹  resolve # ä»¥ä¸‹ã¯ãƒ­ãƒ¼ã‚«ãƒ«ã§ $ ssh -l bandit18 -p 2220 bandit.labs.overthewire.org cat readme This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit18@bandit.labs.overthewire.org&#39;s password: IueksS7Ubh8G3DCwVzrTd8rAVOwq3M5x $ resolveã¾ã§ã«ã‚„ã£ãŸã“ã¨ ãƒ­ã‚°ã‚¤ãƒ³ã§ããªã„ã®ã§ã€sshã§ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œãªã‚‰ã„ã‘ã‚‹ã‹ã¨æ€ã„ã€å®Ÿè¡Œã—ã¦ã¿ãŸã‚‰ã„ã‘ã¾ã—ãŸã€‚åŠä¿¡åŠç–‘ã§ã—ãŸãŒã€sshã§ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã™ã‚‹ã ã‘ãªã®ã§ãƒ­ã‚°ã‚¤ãƒ³æ‰±ã„ã«ã¯ãªã‚‰ãªã„ã¿ãŸã„ã§ã™ã€‚
Level 20 Goal  To gain access to the next level, you should use the setuid binary in the homedirectory.'><title>ã€OverTheWireå¥®é—˜è¨˜ã€‘Bandit: Level19ã€œ21</title>

<link rel='canonical' href='https://tadakun8.github.io/post/over-the-wire/bandit/level19-21/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='ã€OverTheWireå¥®é—˜è¨˜ã€‘Bandit: Level19ã€œ21'>
<meta property='og:description' content='Level 19 Goal  The password for the next level is stored in a file readme in the homedirectory. Unfortunately, someone has modified .bashrc to log you out when you log in with SSH.
  ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯readmeãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚ã‚‹ èª°ã‹ãŒ.bashrcãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿®æ­£ã—ã€SSHã§ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ã¨ãã«ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã™ã‚‹ã‚ˆã†ã«è¨­å®šã—ã¦ã„ã‚‹  resolve # ä»¥ä¸‹ã¯ãƒ­ãƒ¼ã‚«ãƒ«ã§ $ ssh -l bandit18 -p 2220 bandit.labs.overthewire.org cat readme This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit18@bandit.labs.overthewire.org&#39;s password: IueksS7Ubh8G3DCwVzrTd8rAVOwq3M5x $ resolveã¾ã§ã«ã‚„ã£ãŸã“ã¨ ãƒ­ã‚°ã‚¤ãƒ³ã§ããªã„ã®ã§ã€sshã§ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œãªã‚‰ã„ã‘ã‚‹ã‹ã¨æ€ã„ã€å®Ÿè¡Œã—ã¦ã¿ãŸã‚‰ã„ã‘ã¾ã—ãŸã€‚åŠä¿¡åŠç–‘ã§ã—ãŸãŒã€sshã§ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã™ã‚‹ã ã‘ãªã®ã§ãƒ­ã‚°ã‚¤ãƒ³æ‰±ã„ã«ã¯ãªã‚‰ãªã„ã¿ãŸã„ã§ã™ã€‚
Level 20 Goal  To gain access to the next level, you should use the setuid binary in the homedirectory.'>
<meta property='og:url' content='https://tadakun8.github.io/post/over-the-wire/bandit/level19-21/'>
<meta property='og:site_name' content='ãŸã ãã‚“ã¶ã‚ã'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2021-06-20T15:24:42&#43;09:00'/><meta property='article:modified_time' content='2021-06-20T15:24:42&#43;09:00'/>
<meta name="twitter:title" content="ã€OverTheWireå¥®é—˜è¨˜ã€‘Bandit: Level19ã€œ21">
<meta name="twitter:description" content="Level 19 Goal  The password for the next level is stored in a file readme in the homedirectory. Unfortunately, someone has modified .bashrc to log you out when you log in with SSH.
  ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯readmeãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚ã‚‹ èª°ã‹ãŒ.bashrcãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿®æ­£ã—ã€SSHã§ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ã¨ãã«ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã™ã‚‹ã‚ˆã†ã«è¨­å®šã—ã¦ã„ã‚‹  resolve # ä»¥ä¸‹ã¯ãƒ­ãƒ¼ã‚«ãƒ«ã§ $ ssh -l bandit18 -p 2220 bandit.labs.overthewire.org cat readme This is a OverTheWire game server. More information on http://www.overthewire.org/wargames bandit18@bandit.labs.overthewire.org&#39;s password: IueksS7Ubh8G3DCwVzrTd8rAVOwq3M5x $ resolveã¾ã§ã«ã‚„ã£ãŸã“ã¨ ãƒ­ã‚°ã‚¤ãƒ³ã§ããªã„ã®ã§ã€sshã§ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œãªã‚‰ã„ã‘ã‚‹ã‹ã¨æ€ã„ã€å®Ÿè¡Œã—ã¦ã¿ãŸã‚‰ã„ã‘ã¾ã—ãŸã€‚åŠä¿¡åŠç–‘ã§ã—ãŸãŒã€sshã§ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã™ã‚‹ã ã‘ãªã®ã§ãƒ­ã‚°ã‚¤ãƒ³æ‰±ã„ã«ã¯ãªã‚‰ãªã„ã¿ãŸã„ã§ã™ã€‚
Level 20 Goal  To gain access to the next level, you should use the setuid binary in the homedirectory.">
    </head>
    <body class="">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.body.dataset.scheme = 'dark';
        } else {
            document.body.dataset.scheme = 'light';
        }
    })();
</script><div class="container main-container flex on-phone--column extended article-page with-toolbar">
            <aside class="sidebar left-sidebar sticky">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header class="site-info">
        
            <figure class="site-avatar">
                
                    
                    
                    
                        
                        <img src="/img/avatar_huda2458f72ce188392d75c5d51cd8e24e_373_300x0_resize_box_2.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                

                
                    <span class="emoji">ğŸ¥</span>
                
            </figure>
        
        <h1 class="site-name"><a href="https://tadakun8.github.io">ãŸã ãã‚“ã¶ã‚ã</a></h1>
        <h2 class="site-description">æŠ€è¡“ãƒ–ãƒ­ã‚°ã¯ã˜ã‚ã¾ã—ãŸ</h2>
    </header>

    <ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/about/'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        

        <li >
            <a href='/archives/'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        

        <li >
            <a href='/search/'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        
            <li id="dark-mode-toggle">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <span>Dark Mode</span>
            </li>
        
    </ol>
</aside>

            <main class="main full-width">
    <div id="article-toolbar">
        <a href="https://tadakun8.github.io" class="back-home">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



            <span>Back</span>
        </a>
    </div>

    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/overthewire/" >
                OverTheWire
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/post/over-the-wire/bandit/level19-21/">ã€OverTheWireå¥®é—˜è¨˜ã€‘Bandit: Level19ã€œ21</a>
    </h2>

    <footer class="article-time">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <time class="article-time--published">2021-06-20</time>
    </footer></div>
</header>

    <section class="article-content">
    <h2 id="level-19">Level 19</h2>
<h3 id="goal">Goal</h3>
<blockquote>
<p>The password for the next level is stored in a file readme in the homedirectory. Unfortunately, someone has modified .bashrc to log you out when you log in with SSH.</p>
</blockquote>
<ul>
<li>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯<code>readme</code>ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚ã‚‹</li>
<li>èª°ã‹ãŒ<code>.bashrc</code>ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿®æ­£ã—ã€SSHã§ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ã¨ãã«ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã™ã‚‹ã‚ˆã†ã«è¨­å®šã—ã¦ã„ã‚‹</li>
</ul>
<h3 id="resolve">resolve</h3>
<pre><code># ä»¥ä¸‹ã¯ãƒ­ãƒ¼ã‚«ãƒ«ã§
$ ssh -l bandit18 -p 2220 bandit.labs.overthewire.org cat readme
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

bandit18@bandit.labs.overthewire.org's password: 
IueksS7Ubh8G3DCwVzrTd8rAVOwq3M5x
$ 
</code></pre><h3 id="resolveã¾ã§ã«ã‚„ã£ãŸã“ã¨">resolveã¾ã§ã«ã‚„ã£ãŸã“ã¨</h3>
<p>ãƒ­ã‚°ã‚¤ãƒ³ã§ããªã„ã®ã§ã€sshã§ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œãªã‚‰ã„ã‘ã‚‹ã‹ã¨æ€ã„ã€å®Ÿè¡Œã—ã¦ã¿ãŸã‚‰ã„ã‘ã¾ã—ãŸã€‚åŠä¿¡åŠç–‘ã§ã—ãŸãŒã€sshã§ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã™ã‚‹ã ã‘ãªã®ã§ãƒ­ã‚°ã‚¤ãƒ³æ‰±ã„ã«ã¯ãªã‚‰ãªã„ã¿ãŸã„ã§ã™ã€‚</p>
<h2 id="level-20">Level 20</h2>
<h3 id="goal-1">Goal</h3>
<blockquote>
<p>To gain access to the next level, you should use the setuid binary in the homedirectory. Execute it without arguments to find out how to use it. The password for this level can be found in the usual place (/etc/bandit_pass), after you have used the setuid binary.</p>
</blockquote>
<ul>
<li>homeãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚ã‚‹<code>setuid</code>ã‚’å®Ÿè¡Œã—ã€ãã®ã‚ã¨<code>/etc/bandit_pass</code>ã‹ã‚‰ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å–å¾—ã™ã‚‹</li>
</ul>
<h3 id="resolve-1">resolve</h3>
<pre><code>bandit19@bandit:~$ ./bandit20-do cat /etc/bandit_pass/bandit20
GbKksEFF4yrVs6il55v6gwY5aVje5f0j
bandit19@bandit:~$ exit

# ä»¥ä¸‹ã¯ãƒ­ãƒ¼ã‚«ãƒ«ã§
â¯â¯â¯ ssh -l bandit20 -p 2220 bandit.labs.overthewire.org
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

bandit20@bandit.labs.overthewire.org's password: GbKksEFF4yrVs6il55v6gwY5aVje5f0j
</code></pre><h3 id="resolveã¾ã§ã«ã‚„ã£ãŸã“ã¨-1">resolveã¾ã§ã«ã‚„ã£ãŸã“ã¨</h3>
<p><code>ls</code>ã—ã¦ã¿ã‚‹ã¨<code>bandit20 do</code>ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã£ãŸã®ã§ã€ã“ã‚Œã‚’å®Ÿè¡Œã™ã‚‹ã¨ä½¿ã„æ–¹ãŒè¡¨ç¤ºã•ã‚Œã¾ã—ãŸ</p>
<pre><code>bandit19@bandit:~$ ./bandit20-do 
Run a command as another user.
  Example: ./bandit20-do id
</code></pre><p>ã¨ã‚Šã‚ãˆãšExampleã®ã‚ˆã†ã«ã—ã¦ã¿ã¾ã™ã€‚</p>
<pre><code>bandit19@bandit:~$ ./bandit20-do id
uid=11019(bandit19) gid=11019(bandit19) euid=11020(bandit20) groups=11019(bandit19)
</code></pre><p>ãƒ»ãƒ»ãƒ»ã“ã‚Œã§ã„ã„ã®ã‹ï¼Ÿã¨ä¸å®‰ã‚’è¦šãˆãªãŒã‚‰<code>cat</code>ã—ã¦ã¿ã‚‹ã¨</p>
<pre><code>bandit19@bandit:~$ cat /etc/bandit_pass/bandit20
cat: /etc/bandit_pass/bandit20: Permission denied`
</code></pre><p>ã ã‚ã˜ã‚ƒã‚“ï¼</p>
<p>ã†ãƒ¼ã‚“ã¨é¦–ã‚’å‚¾ã’ãªãŒã‚‰è€ƒãˆã¦ã¿ã‚‹ã¨ãƒ»ãƒ»ãƒ»<code>Example: ./bandit20-do id</code>ã®<code>id</code>ã¯ã‚³ãƒãƒ³ãƒ‰ã§ã¯ï¼Ÿã¨ã„ã†ã“ã¨ã«æ°—ã¥ãã¾ã—ãŸã€‚ã¨ã„ã†ã“ã¨ã§ã€<code>./bandit20-do cat /etc/bandit_bass/bandit20</code>ã§ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å–å¾—ã§ãã¾ã—ãŸã€‚</p>
<h2 id="level-21">Level 21</h2>
<h3 id="goal-2">Goal</h3>
<blockquote>
<p>There is a setuid binary in the homedirectory that does the following: it makes a connection to localhost on the port you specify as a commandline argument. It then reads a line of text from the connection and compares it to the password in the previous level (bandit20). If the password is correct, it will transmit the password for the next level (bandit21).
NOTE: Try connecting to your own network daemon to see if it works as you think</p>
</blockquote>
<ul>
<li>setuidãƒã‚¤ãƒŠãƒªã‚’ä½¿ç”¨ã™ã‚‹</li>
<li>ã“ã®ãƒã‚¤ãƒŠãƒªã¯ãƒãƒ¼ãƒˆç•ªå·ã‚’å¼•æ•°ã«ã¨ã‚‹</li>
<li>ãƒ†ã‚­ã‚¹ãƒˆã‚’èª­ã¿å–ã‚Šã€å‰ã®ãƒ¬ãƒ™ãƒ«ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¨æ¯”è¼ƒã—åˆã£ã¦ã„ãŸã‚‰æ¬¡ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¿”ã™</li>
</ul>
<h3 id="resolve-2">resolve</h3>
<pre><code>bandit20@bandit:~$ echo &quot;GbKksEFF4yrVs6il55v6gwY5aVje5f0j&quot; | nc -l localhost -p 61337 &amp;
[4] 2721
bandit20@bandit:~$ ./suconnect 61337
Read: GbKksEFF4yrVs6il55v6gwY5aVje5f0j
Password matches, sending next password
gE269g2h3mw3pwgrj0Ha9Uoqen1c9DGr
[4]   Done                    echo &quot;GbKksEFF4yrVs6il55v6gwY5aVje5f0j&quot; | nc -l localhost -p 61337
bandit20@bandit:~$ exit

# ä»¥ä¸‹ã¯ãƒ­ãƒ¼ã‚«ãƒ«ã§
$ ssh -l bandit21 -p 2220 bandit.labs.overthewire.org
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

bandit21@bandit.labs.overthewire.org's password: gE269g2h3mw3pwgrj0Ha9Uoqen1c9DGr
</code></pre><h3 id="resolveã¾ã§ã«ã‚„ã£ãŸã“ã¨-2">resolveã¾ã§ã«ã‚„ã£ãŸã“ã¨</h3>
<h4 id="ã¾ãšã¯ã‚„ã£ã¦ã¿ã‚‹">ã¾ãšã¯ã‚„ã£ã¦ã¿ã‚‹</h4>
<p><code>ls</code>ã™ã‚‹ã¨ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã£ãŸã®ã§ã€å®Ÿè¡Œã—ã¦è¦‹ã‚‹ã¨ä½¿ã„æ–¹ãŒè¡¨ç¤ºã•ã‚Œã¾ã—ãŸã€‚</p>
<pre><code>bandit20@bandit:~$ ./suconnect 
Usage: ./suconnect &lt;portnumber&gt;
This program will connect to the given port on localhost using TCP. If it receives the correct password from the other side, the next password is transmitted back.
</code></pre><p>ã©ã†ã‚„ã‚‰å¼•æ•°ã«ãƒãƒ¼ãƒˆç•ªå·ã‚’ä¸ãˆã‚‹ã‚ˆã†ã§ã™ã€‚</p>
<p>å•é¡Œæ–‡ã‹ã‚‰ãƒãƒ¼ãƒˆãŒä¸ãˆã‚‰ã‚Œã¦ã„ãªã„ã®ã§ã€<code>nmap</code>ã§ãƒãƒ¼ãƒˆã‚’å—ã‘ä»˜ã‘ã¦ã„ã‚‹ã¨ã“ã‚ã‚’èª¿ã¹ã¦ã¿ã¾ã—ãŸã€‚<code>nmap -p -</code>ã§å…¨ã¦ã®ãƒãƒ¼ãƒˆã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã¾ã™ã€‚</p>
<pre><code>bandit20@bandit:~$ nmap -p - localhost

Starting Nmap 7.40 ( https://nmap.org ) at 2021-06-20 11:56 CEST
Nmap scan report for localhost (127.0.0.1)
Host is up (0.00024s latency).
Not shown: 65525 closed ports
PORT      STATE SERVICE
22/tcp    open  ssh
113/tcp   open  ident
30000/tcp open  ndmps
30001/tcp open  pago-services1
30002/tcp open  pago-services2
31046/tcp open  unknown
31518/tcp open  unknown
31691/tcp open  unknown
31790/tcp open  unknown
31960/tcp open  unknown

Nmap done: 1 IP address (1 host up) scanned in 4.00 seconds
</code></pre><p>è‰²ã€…å‡ºã¦ãã¾ã—ãŸã€‚ã“ã‚Œã«ãƒãƒ¼ãƒˆç•ªå·ã¯ã“ã‚Œã‚‰ãŒå€™è£œã§ã™ã€‚ãªã®ã§ã€ã“ã‚Œã‚‰ã®ãƒãƒ¼ãƒˆç•ªå·ã‚’å¼•æ•°ã«<code>./suconnect</code>ã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ãŸã€‚</p>
<pre><code>bandit20@bandit:~$ ./suconnect 31046
GbKksEFF4yrVs6il55v6gwY5aVje5f0j

</code></pre><p>ãƒ»ãƒ»ãƒ»ãŒã€ä¸€å‘ã«æˆåŠŸã—ã¾ã›ã‚“ã€‚ä»–ã®ãƒãƒ¼ãƒˆã§ã‚‚è©¦ã—ã¦ã¿ã¾ã—ãŸãŒã§ãã¾ã›ã‚“ã§ã—ãŸã€‚</p>
<h4 id="é€”æ–¹ã«æš®ã‚Œã¾ã—ãŸ">é€”æ–¹ã«æš®ã‚Œã¾ã—ãŸ</h4>
<p>NOTEã®<code>NOTE: Try connecting to your own network daemon to see if it works as you think</code>ã‚’ã¿ã¦è¦‹ã¾ã—ãŸãŒã€ã‚ã¾ã‚Šã‚ˆãã‚ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ã“ã®ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã«ã‚‚ã£ã¦ãã‚Œã°ã„ã„ã®ï¼ï¼Ÿã‚ã»ãªé›‘å¿µãŒé ­ã‚’ã‚ˆãã£ãŸã¾ã§ã‚ã‚Šã¾ã™ã€‚<code>Commands you may need to solve this level</code>ã‚’è¦‹ã¦ã¿ã¦ã‚‚ã“ã®ã‚³ãƒãƒ³ãƒ‰ãªã‚‰å‡ºæ¥ãã†ã¨ã„ã†ç›´æ„Ÿã‚‚åƒã‹ãšã€ãšã…ã…ã…ã£ã¨æ‚©ã‚“ã§ã¿ã¾ã—ãŸã€‚</p>
<p>ãã—ã¦ã‚®ãƒ–ã‚¢ãƒƒãƒ—ã§ã™ã€‚</p>
<h4 id="è§£ãæ–¹ã‚’æ•´ç†ã—ã¦ã¿ã‚‹">è§£ãæ–¹ã‚’æ•´ç†ã—ã¦ã¿ã‚‹</h4>
<p>ã“ã®å•é¡Œã«ã¤ã„ã¦èª¿ã¹ã¦ã¿ã‚‹ã¨è§£æ³•ã¯ä»¥ä¸‹ã®ã‚ˆã†ã§ã™</p>
<p><code>nc -l localhost -p 61337</code>ã§localhostã«ã‚µãƒ¼ãƒã‚’ç«‹ã¡ä¸Šã’ã¾ã™ã€‚ãƒãƒ¼ãƒˆã®æŒ‡å®šã§ã™ãŒã€<code>nmap -p -</code>ã§å‡ºã¦ããŸãƒãƒ¼ãƒˆã¯ã™ã§ã«ã‚µãƒ¼ãƒ“ã‚¹ãŒå‹•ã„ã¦ã„ã‚‹ã®ã§ãã‚Œä»¥å¤–ã‚’æŒ‡å®šã—ã¾ã™ã€‚</p>
<p>æ¬¡ã«ã€ä¸Šè¨˜ãƒãƒ¼ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã¨ãã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯Level20ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãªã®ã§ã€ãã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸéš›ã«è¿”ã™ã‚ˆã†ã«å®šç¾©ã—ã¾ã™ã€‚</p>
<pre><code>echo &quot;GbKksEFF4yrVs6il55v6gwY5aVje5f0j&quot; | nc -l localhost -p 61337
</code></pre><p>ncã‚³ãƒãƒ³ãƒ‰ã¯ãƒ‘ã‚¤ãƒ—ã§æ¨™æº–å…¥åŠ›ã‚’å—ã‘ä»˜ã‘ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã§ã™ã€‚</p>
<p>ä¸Šè¨˜ã‚’ãã®ã¾ã¾å‹•ã‹ã™ã¨<code>./suconnect</code>ãŒæ‰“ã¦ã¾ã›ã‚“ã€‚ãªã®ã§ã€ä¸Šè¨˜ã¯ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§å‹•ã‹ã™ãŸã‚ã«<code>&amp;</code>ã‚’ã¤ã‘ã¾ã—ã‚‡ã†</p>
<pre><code>echo &quot;GbKksEFF4yrVs6il55v6gwY5aVje5f0j&quot; | nc -l localhost -p 61337 &amp;
</code></pre><p>ã“ã‚Œã§<code>./suconnect</code>æ‰“ã¦ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚ã‚ã¨ã¯<code>./succonect 61337</code>ã¨æ‰“ã¦ã°æ¬¡ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒè¿”ã£ã¦ãã¾ã™ã€‚</p>
<h4 id="å‚è€ƒ">å‚è€ƒ</h4>
<ul>
<li><a class="link" href="https://www.intellilink.co.jp/column/security/2015/070100.aspx"  target="_blank" rel="noopener"
    >ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨ºæ–­ã®ç¾å ´ã‹ã‚‰ï¼ˆnetcatç·¨ãƒ»ãã®1ï¼‰</a></li>
<li><a class="link" href="https://medium.com/secttp/overthewire-bandit-level-20-a1af9a042c56"  target="_blank" rel="noopener"
    >OverTheWire: Bandit Level 20</a></li>
<li><a class="link" href="https://medium.com/@theGirlWhoEncrypts/overthewire-bandit-level-20-level-21-d64ffa5d7802"  target="_blank" rel="noopener"
    >&lt;/ OverTheWire &gt; Bandit Level 20 â†’ Level 21</a></li>
</ul>
<h3 id="ãŠã‚ã‚Šã«">ãŠã‚ã‚Šã«</h3>
<p>Level21é›£ã—ã‹ã£ãŸã§ã™ã€‚åˆã‚ã¦ã‚®ãƒ–ã‚¢ãƒƒãƒ—ã‚’ã—ã¦ã—ã¾ã£ãŸã®ãŒã™ã”ãæ‚”ã—ã„ï¼</p>
<blockquote>
<p>NOTE: Try connecting to your own network daemon to see if it works as you think</p>
</blockquote>
<p>çµ‚ã‚ã£ãŸå¾Œã«æŒ¯ã‚Šè¿”ã‚‹ã¨ã“ã‚ŒãŒãƒ’ãƒ³ãƒˆã«ã¯ãªã£ã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ãŒã€ã“ã®Goalã‚’ã¿ã¦è‡ªåˆ†è‡ªèº«ã§<code>nc</code>ã‚³ãƒãƒ³ãƒ‰ã§ã‚µãƒ¼ãƒã‚’ç«‹ã¡ä¸Šã’ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯å‰ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¿”ã›ã°ã„ã„ã‚“ã ï¼ãƒ»ãƒ»ãƒ»ã¨ãªã‚‹äººãŒã©ã‚Œãã‚‰ã„ã„ã‚‹ã®ã§ã—ã‚‡ã†ï¼Ÿã‚¬ãƒãƒ—ãƒ­ãƒãƒƒã‚«ãƒ¼ãªã‚‰ã“ã®ç¨‹åº¦æœé£¯å‰ã®ç†è§£ãªã®ã§ã—ã‚‡ã†ã‹ã€‚ç§ã‚‚ã¾ã ã¾ã ãªã‚ˆã†ã§ã™ã€‚ç²¾é€²ã—ã¾ã™ï¼</p>

</section>


    <footer class="article-footer">
    

    </footer>

    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="">
    <a href="/post/over-the-wire/bandit/level28-30/">
        
        

        <div class="article-details">
            <h2 class="article-title">ã€OverTheWireå¥®é—˜è¨˜ã€‘Bandit: Level28ã€œ30</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/over-the-wire/bandit/level25-27/">
        
        

        <div class="article-details">
            <h2 class="article-title">ã€OverTheWireå¥®é—˜è¨˜ã€‘Bandit: Level25ã€œ27</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/over-the-wire/bandit/level22-24/">
        
        

        <div class="article-details">
            <h2 class="article-title">ã€OverTheWireå¥®é—˜è¨˜ã€‘Bandit: Level22ã€œ24</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/over-the-wire/bandit/level16-18/">
        
        

        <div class="article-details">
            <h2 class="article-title">ã€OverTheWireå¥®é—˜è¨˜ã€‘Bandit: Level16ã€œ18</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/over-the-wire/bandit/level14-15/">
        
        

        <div class="article-details">
            <h2 class="article-title">ã€OverTheWireå¥®é—˜è¨˜ã€‘Bandit: Level14ã€œ15</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>


    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2021 ãŸã ãã‚“ã¶ã‚ã
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="2.3.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >
            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
